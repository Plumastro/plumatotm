Functional Requirement Specification (FRS)
Projet : GÃ©nÃ©rateur de Birth Chart Astrologique
 RÃ©fÃ©rence visuelle : Birth_Chart_Reference.png

1. Objectif
DÃ©velopper un module Python qui gÃ©nÃ¨re automatiquement une birth chart (thÃ¨me natal astrologique) Ã  partir des donnÃ©es de naissance dâ€™un client.
 La birth chart est une reprÃ©sentation graphique en cercle indiquant :
Les 12 signes du zodiaque disposÃ©s en cercle


Les 12 maisons astrologiques


Les positions des planÃ¨tes et points sensibles (Ascendant, Milieu du Ciel, NÅ“ud Nord)


Les aspects majeurs entre planÃ¨tes (traits reliant les planÃ¨tes)


Le rÃ©sultat doit Ãªtre exportÃ© en image .png de taille ~1500x1500 px avec fond blanc.

2. Technologies UtilisÃ©es
flatlib â†’ calculs astrologiques (planÃ¨tes, maisons, aspects)


timezonefinder â†’ dÃ©tection automatique du fuseau horaire


zoneinfo â†’ gestion des conversions UTC/local time


matplotlib + PIL â†’ gÃ©nÃ©ration graphique en cercle


Custom icons PNG â†’ planÃ¨tes, signes, maisons



3. Inputs
Le module reÃ§oit les donnÃ©es dâ€™un client :
Date de naissance (AAAA-MM-JJ)


Heure de naissance (HH:MM, format 24h)


Lieu de naissance (latitude, longitude)


Processus automatisÃ© :
Validation du format (date, heure, coordonnÃ©es).


DÃ©tection automatique du fuseau horaire.


Conversion heure locale â†’ UTC.


Calcul du thÃ¨me avec flatlib (zodiaque tropical, maisons Placidus par dÃ©faut, NÅ“ud Nord moyen).



4. Outputs
Un fichier .png :


Taille : 1500x1500 pixels


Fond blanc


Nom de fichier : birth_chart_CLIENT.png



5. Contraintes de Design
Style : Minimaliste, noir et blanc avec aspects colorÃ©s.


Polices : sobres, sans empattement.


Pas d'angles (longitude Ã©cliptique) affichÃ©s.


IcÃ´nes PNG :


PlanÃ¨tes : Sun.png, Moon.png, Mercury.png, etc.


Signes : ARIES.png, TAURUS.png, etc.


Maisons : 1.png, 2.png, etc.


Aspects : Seuls Ã©lÃ©ments en couleur (sextile violet, carrÃ© rouge, trigone vert, opposition bleu, conjonction noir).


Positionnement :


Les signes zodiacaux rÃ©partis Ã  30Â° chacun.


Les maisons superposÃ©es selon le systÃ¨me choisi (Placidus/Porphyry).


Les planÃ¨tes affichÃ©es selon la nouvelle gÃ©omÃ©trie : encoche â†’ icÃ´ne â†’ nÅ“ud.


GÃ©omÃ©trie des planÃ¨tes (du plus extÃ©rieur au plus intÃ©rieur) :
- Encoche : petit trait plein Ã©pais (3px) perpendiculaire au cercle pointillÃ©
- IcÃ´ne PNG : placÃ©e juste en dessous de l'encoche
- NÅ“ud : petit cercle vide, le plus proche du centre


Aspects majeurs reprÃ©sentÃ©s par des traits colorÃ©s reliant les nÅ“uds :


Conjonction (0Â° Â± 8Â°) : noir, ligne pleine, 3px


Sextile (60Â° Â± 6Â°) : violet, tirets 6 on / 6 off, 2px


CarrÃ© (90Â° Â± 6Â°) : rouge, ligne pleine, 2px


Trigone (120Â° Â± 6Â°) : vert, tirets 10 on / 8 off, 2px


Opposition (180Â° Â± 8Â°) : bleu, dash-dot 4 on / 4 off / 1 on / 4 off, 2px



6. Structure Fonctionnelle
Cercle externe â†’ 12 signes (icÃ´nes aux positions fixes, chaque 30Â°).


Cercle interne â†’ 12 maisons (icÃ´nes des maisons alignÃ©es sur leur cusp).


PlanÃ¨tes â†’ placÃ©es selon leur longitude zodiacale exacte.


Traits dâ€™aspects â†’ reliants les planÃ¨tes impliquÃ©es.


Ascendant (AC) et MC (Milieu du Ciel) â†’ marquÃ©s par leurs icÃ´nes respectives.



7. Exemple de Workflow
Input : 1986-11-09 16:28 GenÃ¨ve (46.2044, 6.1432)


Conversion heure locale â†’ UTC.


flatlib calcule :


Soleil en Scorpion Ã  16Â°56â€™


Lune en Verseau Ã  9Â°12â€™


Ascendant Ã  12Â° GÃ©meaux


etc.


GÃ©nÃ©ration dâ€™un .png avec :


Soleil placÃ© dans le secteur Scorpion


Lune dans le secteur Verseau


Ascendant marquÃ© en GÃ©meaux


Traits reliant Soleil-Lune (carrÃ©, si aspect exact)



8. RÃ¨gles Astrologiques Ã  Respecter
Zodiaque tropical occidental


Maisons Placidus (option Porphyry si haute latitude)


Orbes standards pour les aspects :


Conjonction : Â±8Â°


Opposition : Â±8Â°


CarrÃ© : Â±6Â°


Trigone : Â±6Â°


Sextile : Â±6Â°


Inclure uniquement les aspects majeurs



9. Contraintes Techniques
RÃ©sultat vectorisÃ© au maximum pour garder la nettetÃ©.


Export .png fond transparent, 1500x1500px.


Tous les calculs (planÃ¨tes, maisons, aspects) doivent venir de flatlib.


Pas de donnÃ©es Ã©crites (pas de degrÃ©s, pas de noms de planÃ¨tes) â†’ uniquement icÃ´nes et lignes.



10. Indications de Design

Vue d'ensemble

Format image : 1500Ã—1500 px, fond blanc.

Centre : (750, 750). Rayon utile R â‰ˆ 700 px (laisse ~50 px de marge).

SystÃ¨me angulaire : 0Â° en haut (Nord) = 0Â° BÃ©lier ; angles sens horaire.

Ordre visuel (de l'extÃ©rieur vers l'intÃ©rieur) :

Bande des signes (cercle externe segmentÃ© en 12 parts de 30Â°)

RepÃ¨res radiaux (pointillÃ©s/dashes)

Bande des maisons (donut interne avec 12 secteurs et cuspides)

NÅ“ud des aspects (lignes reliant les planÃ¨tes)

IcÃ´nes des planÃ¨tes/points (placÃ©es sur un rayon fixe)

NB Plumastro : tout en noir (noir pur), pas de texte, pas de degrÃ©s ; utiliser icÃ´nes PNG (signes, planÃ¨tes, maisons).

Couches et gÃ©omÃ©trie (rayons en % de R)
Ã‰lÃ©ment	Rayon / Ã‰paisseur	DÃ©tails
Bande des signes (outer ring)	R*0.83 â†’ R*0.97 (Ã©paisseur ~0.14R)	12 secteurs de 30Â°. Chaque limite de signe = trait fin (2 px). IcÃ´ne de signe au centre du secteur (angle milieu, r = R*0.90). Taille icÃ´ne ~42â€“52 px.
Tick radiaux "signes"	traits Ã  chaque 30Â°	Traits pointillÃ©s du bord interne de la bande des signes (R*0.83) jusqu'Ã  R*0.40. Dash pattern p.ex. 6 px on / 6 px off, 1 px d'Ã©paisseur.
RepÃ¨res radiaux mineurs (option)	tous les 15Â°	Identiques mais plus fins/courts (jusqu'Ã  R*0.55).
Cercles pointillÃ©s (grille)	R*{0.18, 0.28, 0.38, 0.48, 0.58, 0.68}	Concentriques, pointillÃ©s noirs 1 px. Ils structurent l'intÃ©rieur et donnent l'aspect "grille" discret de la rÃ©fÃ©rence.
Bande des maisons	R*0.27 â†’ R*0.42	Donut interne. Cuspides de maison = rayons calculÃ©s (Placidus ou Porphyry). Entre R*0.27 et R*0.35 : trait plein. De R*0.35 Ã  R*0.83 : prolongement en pointillÃ©s (c'est le "tiret vers l'extÃ©rieur" visible sur la rÃ©fÃ©rence).
IcÃ´nes des maisons	r = R*0.33	IcÃ´ne 1.pngâ€¦12.png posÃ©e au milieu angulaire de chaque maison, taille ~22â€“28 px.
PlanÃ¨tes & points (AC, MC, NN)	r = R*0.60 (orbite d'affichage)	Place chaque icÃ´ne Ã  son angle Ã©cliptique. Taille ~34â€“44 px (adapter pour Ã©viter les collisions). Jitter radial de Â±0.015R (Â±10 px) si deux corps Ã  < 2Â°. AC & MC peuvent avoir r = R*0.76 pour Ãªtre plus lisibles prÃ¨s de la couronne.
Lignes d'aspects	dans R*0.20 â†’ R*0.65	Droites centre-Ã -centre entre planÃ¨tes. Ã‰paisseur 2 px. (En N&B : soit toutes pleines, soit styles par aspect : conjonction = plein 3 px, sextile = courts tirets, carrÃ© = plein 2 px, trigone = longs tirets, opposition = pointillÃ©/dash-dot).

DÃ©tails d'implantation

1) Bande des signes (12Ã—30Â°)

DÃ©coupe le cercle en 12 secteurs Ã©gaux (commenÃ§ant Ã  0Â° BÃ©lier en haut).

Au milieu de chaque secteur (ex. BÃ©lier Ã  15Â° du secteur), place l'icÃ´ne PNG du signe Ã  r = R*0.90.

Limite de secteur (0/30/60â€¦Â°) : petit trait plein de 2 px qui traverse la bande des signes (R*0.97 â†’ R*0.83).

Pas de texte ni degrÃ©s.

2) RepÃ¨res radiaux (dashes vers l'extÃ©rieur)

Pour chaque cuspide de maison (angle rÃ©el calculÃ©), dessine :

Segment plein de r = R*0.27 â†’ R*0.35 (dans la bande des maisons).

Prolongement pointillÃ© de r = R*0.35 â†’ R*0.83 (traverse la zone intÃ©rieure jusqu'Ã  la base de la bande des signes).

Ã‰paisseurs : 2 px (plein), 1 px (pointillÃ©).

RepÃ¨res de signes (chaque 30Â°) : pointillÃ©s du bord interne de la couronne (R*0.83) vers l'intÃ©rieur (jusqu'Ã  ~R*0.40) pour l'aspect "filets" de la rÃ©fÃ©rence.

Mineurs 15Â° (option) : plus courts et plus fins.

3) Bande des maisons (donut interne)

Anneau R*0.27 â†’ R*0.42.

Les cuspides sont des rayons aux angles calculÃ©s (AC est cuspide maison 1 ; MC = cuspide maison 10).

Chaque secteur de maison peut avoir un lÃ©ger aplat transparent (facultatif) ; en N&B minimaliste, laisser transparent.

Placer l'icÃ´ne de maison (1â€“12) au centre angulaire du secteur, r = R*0.33.

Pas de texte (les numÃ©ros sont apportÃ©s par les PNG).

4) PlanÃ¨tes et points

Convertir la longitude en angle d'affichage :
theta = 90Â° - longitude (mod 360), en radians pour la polar. (0Â° BÃ©lier = haut, sens horaire).

Placer les icÃ´nes PNG (Soleil, Lune, Mercure, â€¦, NN, AC, MC) :

PlanÃ¨tes : r = R*0.60.

AC/MC : r = R*0.76 (plus proche de la couronne pour rappeler leur rÃ´le d'axes).

Gestion de collisions : si |Î”long| < 2Â°, dÃ©caler radialement l'un des deux de Â±0.015R (prioritÃ© : garder Soleil/Lune au rayon nominal, dÃ©caler les autres).

Option rÃ©trogrades : petit chevron ou suffixe "R" n'est pas requis (Plumastro N&B minimal).

5) Aspects majeurs

DÃ©tecter conjonction, sextile, carrÃ©, trigone, opposition avec les orbes FRS.

Tracer une ligne entre les centres des icÃ´nes (ou un point lÃ©gÃ¨rement Ã  l'intÃ©rieur, p. ex. r = R*0.58, pour Ã©viter de toucher le bord des glyphes).

Ã‰paisseur 2 px (N&B).

Si diffÃ©renciation requise sans couleur :

Conjonction : plein 3 px

Sextile : 6 on / 6 off

CarrÃ© : plein 2 px

Trigone : 10 on / 8 off

Opposition : 4 on / 4 off / point (dash-dot)

Z-order : d'abord les lignes d'aspect, par-dessus les grilles, sous les icÃ´nes planÃ¨tes.

RÃ¨gles d'orientation et cohÃ©rence

Signe fixe en haut : 0Â° BÃ©lier au zÃ©nith (comme la rÃ©fÃ©rence).

Maisons tournÃ©es par les cuspides rÃ©elles : l'ascendant tombe oÃ¹ il doit (souvent Ã  gauche) et entraÃ®ne la rotation de la bande des maisons uniquement, pas celle des signes.

Les prolongements pointillÃ©s des cuspides assurent la lecture visuelle "de la maison vers l'extÃ©rieur".

Aucune valeur chiffrÃ©e (degrÃ©s, minutes), aucun nom : uniquement icÃ´nes et traits.

Tailles & styles (reco)

Traits pleins (limites, cuspides internes) : 2 px.

PointillÃ©s : 1 px, dash pattern rÃ©gulier.

IcÃ´nes signes : 42â€“52 px, planÃ¨tes : 34â€“44 px, maisons : 22â€“28 px.

Marges min. depuis le bord : â‰¥ 40 px.

Tout en noir (#000000) ; arriÃ¨re-plan blanc.

RÃ©sultat attendu

Une image .png 1500Ã—1500 avec fond blanc, oÃ¹ :

La couronne des signes segmente clairement le cercle (icÃ´nes de signes centrÃ©es).

Les maisons sont lisibles via la bande interne et leurs cuspides prolongÃ©es en pointillÃ©s vers l'extÃ©rieur.

Les planÃ¨tes sont nettes, non chevauchÃ©es.

Les aspects forment une toile rÃ©guliÃ¨re au centre, sans codes couleur, sans textes.

11. Positionnement des Signes dans une Birth Chart

Zodiaque = cercle de 360Â° divisÃ© en 12 signes (30Â° chacun).

BÃ©lier commence Ã  0Â°, Taureau Ã  30Â°, GÃ©meaux Ã  60Â°, etc.

Cet ordre ne change jamais.

Ascendant (AC) = point le plus Ã  l'Est au moment de la naissance.

C'est la longitude zodiacale qui se lÃ¨ve Ã  l'horizon Est.

En astrologie, l'Ascendant marque toujours le dÃ©but de la Maison I.

Placement dans la roue :

L'Ascendant se trace toujours Ã  gauche du cercle (9h sur une horloge).

Cela signifie que le signe oÃ¹ se trouve l'Ascendant est placÃ© Ã  gauche de la roue.

Exemple : si ton Ascendant est en Cancer 15Â°, alors le Cancer dÃ©marre Ã  gauche de la roue, Maison I.

Le signe suivant (Lion) s'enchaÃ®ne en sens antihoraire (Lion â†’ Vierge â†’ Balanceâ€¦).

MC (Milieu du Ciel) = le point culminant au Sud.

Il tombe automatiquement en haut de la carte (12h d'une horloge).

C'est le dÃ©but de la Maison X.

Il correspond au signe qui culmine au moment de naissance.

RÃ©sumÃ© pratique pour l'implÃ©mentation

Ascendant toujours Ã  gauche (dÃ©but Maison I).

Signe Ascendant = signe qui commence la roue, placÃ© Ã  gauche.

Les 12 signes suivent dans l'ordre antihoraire autour du cercle.

MC (Milieu du Ciel) tombe en haut de la roue (dÃ©but Maison X).

Ainsi, la roue est tournÃ©e selon la naissance :

Pas de signe fixe en haut,

Pas de BÃ©lier imposÃ© en haut,

Tout dÃ©pend de l'Ascendant calculÃ© avec flatlib.

Exemple concret

Ascendant en Balance 29Â° â†’ La Balance dÃ©marre Ã  gauche (Maison I).

La Maison II commence en Scorpion, puis Maison III en Sagittaire, etc.

MC (Milieu du Ciel) tombera peut-Ãªtre en Cancer, en haut.

ğŸ‘‰ Donc, ce que tu as montrÃ© sur l'image prÃ©cÃ©dente (BÃ©lier en haut) est une reprÃ©sentation standardisÃ©e (utile pour manuels d'astro), mais une birth chart rÃ©elle est toujours tournÃ©e pour aligner :

Ascendant Ã  gauche (Maison I)

MC en haut (Maison X)

12. Corrections et AmÃ©liorations du Design

ProblÃ¨mes observÃ©s et corrections demandÃ©es :

1. VisibilitÃ© des planÃ¨tes
- ProblÃ¨me : Les planÃ¨tes ne sont pas visibles (icÃ´nes manquantes ou trop petites)
- Correction : Afficher chaque planÃ¨te (et points AC, MC, NN) sous forme d'icÃ´ne PNG ou d'un point noir si icÃ´ne absente
- Taille icÃ´ne : ~40 px
- Rayon de placement : r = 0.60R (entre la couronne des maisons et le centre)
- Z-order : Toujours au-dessus des traits et des aspects

2. Positionnement de l'Ascendant
- ProblÃ¨me : L'Ascendant n'est pas positionnÃ© Ã  gauche (9h sur l'horloge)
- Correction : Forcer le dÃ©but de la Maison I (Ascendant) Ã  Ãªtre Ã  gauche de la roue
- Le signe de l'Ascendant doit commencer Ã  cet endroit
- Les signes tournent ensuite en sens antihoraire autour du cercle
- Le MC (Maison X) doit automatiquement tomber en haut

3. Couronne des maisons (donut)
- ProblÃ¨me : Trop Ã©paisse et trop petite
- Correction : RÃ©duire le diamÃ¨tre intÃ©rieur (plus proche du centre)
- Nouveaux rayons : intÃ©rieur = 0.35R, extÃ©rieur = 0.45R
- RÃ©sultat : Une bande plus fine, mais un peu plus grande

4. Couronne des signes
- ProblÃ¨me : Trop fine
- Correction : Ã‰largir la bande en rÃ©duisant le rayon intÃ©rieur
- Nouveaux rayons : intÃ©rieur = 0.70R, extÃ©rieur = 0.97R (inchangÃ©)
- Le diamÃ¨tre extÃ©rieur ne doit pas changer (pour garder la taille totale)

5. Aspects colorÃ©s
- ProblÃ¨me : Aucune ligne d'aspect n'apparaÃ®t
- Correction : Dessiner les aspects entre planÃ¨tes visibles uniquement
- Styles demandÃ©s :
  - Sextile (60Â°) : violet, tirets 6 on / 6 off, 2 px
  - CarrÃ© (90Â°) : rouge, ligne pleine, 2 px
  - Trigone (120Â°) : vert, tirets 10 on / 8 off, 2 px
  - Opposition (180Â°) : bleu, motif dash-dot 4 on / 4 off / 1 on / 4 off, 2 px
  - Conjonction (0Â°) : noir, ligne pleine, 3 px
- Les aspects sont le seul Ã©lÃ©ment en couleur

6. Position des aspects
- ProblÃ¨me : Les aspects sont absents
- Correction : Les aspects doivent apparaÃ®tre Ã  l'intÃ©rieur de la couronne des maisons
- Tracer les lignes uniquement Ã  l'intÃ©rieur du diamÃ¨tre intÃ©rieur de la couronne des maisons

Nouveaux rayons spÃ©cifiÃ©s (v2.0) :
- Couronne des signes : intÃ©rieur = 0.70R, extÃ©rieur = 0.97R
- Couronne des maisons : intÃ©rieur = 0.35R, extÃ©rieur = 0.45R
- Cercle pointillÃ© (rayon de positionnement) : 0.68R
- GÃ©omÃ©trie des planÃ¨tes :
  - Encoche : de 0.68R vers 0.65R (longueur 0.03R)
  - IcÃ´ne : 0.64R (espace 0.01R depuis l'encoche)
  - NÅ“ud : 0.63R (espace 0.01R depuis l'icÃ´ne)
- Aspects : reliant les nÅ“uds (0.63R)
- Z-order : grille(1) < cuspides(5) < encoches(6) < nÅ“uds(7) < aspects(8) < icÃ´nes(10)

13. SpÃ©cifications Finales v2.0 - GÃ©omÃ©trie des PlanÃ¨tes

Nouvelle reprÃ©sentation des planÃ¨tes avec gÃ©omÃ©trie professionnelle :

1. Cercle pointillÃ© unique (rayon 0.68R) = rayon de positionnement des planÃ¨tes

2. Pour chaque planÃ¨te, le long du mÃªme rayon (du plus extÃ©rieur au plus intÃ©rieur) :
   - Encoche : petit trait plein Ã©pais (3px) perpendiculaire au cercle pointillÃ©
   - IcÃ´ne PNG : placÃ©e juste en dessous de l'encoche (rayon 0.64R)
   - NÅ“ud : petit cercle vide (rayon 6px), le plus proche du centre (rayon 0.63R)

3. Aspects : traits colorÃ©s reliant nÅ“ud â†’ nÅ“ud (pas centre d'icÃ´ne)

4. Z-order hiÃ©rarchique :
   - Grille (1) < Cuspides (5) < Encoches (6) < NÅ“uds (7) < Aspects (8) < IcÃ´nes (10)

5. Fond blanc (PNG non transparent)

6. Orientation : AC Ã  gauche, MC en haut, ordre anti-horaire

ğŸ‘‰ RÃ©sumÃ© pour Cursor :
 Tu dois coder un gÃ©nÃ©rateur de birth chart astrologique avec aspects colorÃ©s et gÃ©omÃ©trie professionnelle des planÃ¨tes, utilisant flatlib pour calculer les positions, matplotlib/PIL pour dessiner le cercle et les icÃ´nes PNG (planÃ¨tes, signes, maisons). Le rendu final est un .png avec fond blanc de 1500x1500px, contenant :
Les 12 signes du zodiaque


Les 12 maisons


Les planÃ¨tes avec gÃ©omÃ©trie encoche â†’ icÃ´ne â†’ nÅ“ud


Les aspects majeurs reprÃ©sentÃ©s par des traits colorÃ©s reliant les nÅ“uds


Positionnement correct : Ascendant Ã  gauche, MC en haut, sens anti-horaire

